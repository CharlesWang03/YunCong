OK我们来进行一项功能开发。背景是我在秋招，遇到一家公司给我留了一个开发题目，我需要在你的协同下尽量去实现要求。

题目如下：
数据分析助手
要求：导入给定的一个“待售房产列表”的Excel文件，用户输入购房要求，可以筛选出符合条件的房产。

已知没有测试集，训练数据和测试数据需要我们自习构造。
请你先协助我分析一下我们的开发思路，是否需要使用大模型或者能通过其他算法角度实现。建议分成不同的模块不同的步骤来讲述。


Data: List of property
input: preference
output: list of property



## 0. 先把问题说清楚（我们自己补全一些假设）

假设 Excel 里有类似这些字段：

* `house_id`
* `city / district`（城市/区域）
* `total_price`（总价）
* `unit_price`（单价）
* `area`（面积）
* `bedrooms`（几室）
* `floor`（楼层）
* `year_built`（建造年份）
* `distance_to_subway`（到地铁距离/时间）
* `tags`（学区房、精装、近地铁…）

用户输入的“购房要求”可能是两种形式：

1. **结构化表单**：

   * 城市=上海
   * 总价≤500万
   * 面积≥80O
   * 至少3室
2. **自然语言**：

   * “我要上海徐汇，预算 500 万以内，最好近地铁，两室以上”

我们的目标：

* 把 Excel 读进来 → 清洗 → 根据用户要求筛选 → 排序、展示
* 如果要体现“算法/AI能力”，可以加：推荐排序、价格预估、自然语言解析。

---

## 1. 基础版：不依赖大模型的“数据筛选系统”

这条路线足够应付正常业务需求，也更适合展示你**工程 & 数据处理能力**。

### 1.1 数据层模块（Data Layer）

**职责：**

* 导入 Excel
* 做基本数据清洗、类型转换
* 提供统一的数据访问接口

**实现要点：**

* 使用 `pandas` 读取 Excel → DataFrame
* 字段统一：中文列名改成英文/统一命名
* 字段类型转换：字符串→数值、日期解析
* 处理缺失值、异常值（如面积 0、价格 0）

可以设计一个 `DataRepository` 类，例如：

* `load_data()`
* `get_all_properties()`
* `filter_by_conditions(conditions_dict)`

> 这里没有“训练/测试集”的概念，只是普通的数据读写。

---

### 1.2 需求解析模块（Requirement Parsing）

**版本 A：结构化输入**
最简单，直接给用户一组可选字段：

* 城市/区域（下拉）
* 预算区间
* 面积区间
* 最小卧室数量
* 是否必须近地铁（布尔）

这种方式完全不需要 NLP，也不需要大模型，后台拿到的就是一个 `dict`，直接喂给筛选引擎。

**版本 B：简易规则 + 关键词解析（不用大模型）**
允许用户输入一句话，然后你用一些规则做粗糙解析，比如：

* 用正则提取数字区间（300C500 万）
* 识别关键词：

  * “徐汇、浦东、朝阳” → 区域
  * “近地铁、学区、南北通透、精装” → 标签
  * “两室、三室” → 卧室数量

这一块可以用纯 Python + 正则/关键词词典，**不需要大模型也能做得像模像样**。

---

### 1.3 筛选引擎模块（Filter Engine）

**职责：**
把“需求解析模块”输出的结构化条件，转换成对 DataFrame 的过滤逻辑。

例如条件结构：

```python
conditions = {
    "city": "上海",
    "district_in": ["徐汇", "浦东"],
    "total_price_max": 500,
    "area_min": 80,
    "bedrooms_min": 2,
    "tags_include": ["近地铁"],
}
```

内部实现：

* 动态拼接布尔条件：

  * `df["city"] == conditions["city"]`
  * `df["district"].isin(...)`
  * `df["total_price"] <= 500`
  * …
* 支持组合：AND / OR（比如多个区域是 OR，其他条件是 AND）
* 最后返回一个筛选后的 DataFrame

还可以加一个**简单打分/排序**：

* 默认排序：

  * 价格从低到高
  * 或距离地铁从近到远
* “匹配度”打分（不用 ML，只是规则）：

  * 每满足一个用户偏好就 +1 分，再按分数排序

---

### 1.4 界面/接口模块（Interface）

看你时间和精力，可以选不同方案：

* 最快：命令行交互（CLI）

  * 输入条件 → 打印前 N 条结果（表格）
* 稍微好看一点：终端 TUI / 简易菜单
* 更工程向：写个 FastAPI / Flask 接口

  * 提供 `POST /search`，接收 JSON 条件，返回 JSON 列表
* 最体面：用 Streamlit / Gradio 做一个简单 Web 页

  * 左侧是筛选条件表单，右侧是结果表格

> 对面试官可以说：“我会先从 CLI/FastAPI 版做起，确认核心筛选逻辑，再视时间用 Streamlit 做个 Demo 页面。”

---

## 2. 进阶版：引入“大模型/NLP”的地方

现在回答你最关心的：**要不要用大模型？**

### 2.1 必须用吗？

**不必须。**
就“导入房产 Excel + 根据条件筛选”这个需求而言，完全可以用传统编程解决。

但是：
对方是 AI 公司 / 算法岗位的话，**你可以主动设计一个“大模型加分项”**，展示你对大模型在业务中的落地点的理解。

### 2.2 大模型可以做哪些“加分点”？

你可以设计成**分层架构**：

#### 加分点 1：自然语言到结构化条件（NL → Filters）

* 用户输入：“我想要深圳南山，预算 500 万以内，两室，地铁 1 公里内”
* 你用一个大模型（OpenAI / DeepSeek / Qwen 都行）做 function calling：

  * 让大模型帮你提取：

    * `city="深圳"`
    * `district="南山"`
    * `max_price=500`
    * `min_bedrooms=2`
    * `max_distance_to_subway=1`

**训练/测试数据的构造思路：**

* 手动写 50~100 条自然语言查询
* 手动标注对应的结构化字段
* 把 80% 作为“开发/调试集”，20% 留作“测试集”，用来评估识别准确率
* 你可以不自己训练模型，而是用这些数据来评估**提示词工程（prompt）+ 大模型**效果

这样你就既符合“训练/测试需要我们自建”的要求，又不会陷入自己训练一个 NLP 模型的坑。

#### 加分点 2：房价/价值评分模型（回归/推荐）

设计一个简单的**回归模型**，给每套房子一个“性价比评分”。

* 特征：面积、单价、楼层、建成年份、距离地铁、是否学区…
* 标签：

  * 若有历史成交/估价数据，可以拟合成交价
  * 若没有，可以自己手工打分（比如选一小部分房源，主观给 1C5 分）

构造训练/测试：

* 从 Excel 中抽取特征
* 手工给 N 条房源打标签（评分）
* 按 8:2 划分训练/测试
* 训练一个简单模型：线性回归、随机森林、XGBoost 都行
* 用训练好的模型给所有房源打分 → 排序展示“推荐”结果

> 这块主要展示你“会设计特征 + 划分训练/测试集 + 做模型评估（MSE / MAE / R?）”。

---

### 2.3 行业感比较强的说法

在面试里你可以这么总结：

* “**V1**：我先用传统数据处理方式实现一个稳定可用的筛选工具，保证业务功能完备和代码工程化（数据清洗、条件过滤、接口/界面）。”
* “**V2**：在此基础上引入大模型，实现自然语言购房需求解析（NL2Filters），并通过自构建的 Query-Label 数据集评估解析准确率。”
* “**V3**：如果有更多时间，会增加一个简单的价格/性价比预测模型，用特征工程 + 回归模型给每套房子打分，实现‘智能排序推荐’，同时展示我对训练集/测试集划分和模型评估的理解。”

这样既表现你不会“动不动就上大模型”，又能体现你理解大模型最适合解决的是哪一块问题（自然语言理解/模糊偏好）。

---

## 3. 关于“没有测试集，需要自己构造”的理解

你可以从两层来回答：

1. **数据集层面**

   * 当前只给了一份 Excel，没有严格区分“训练/测试”
   * 做模型（例如回归/推荐）时，可以从这份数据里：

     * 随机划分训练/验证/测试
     * 或用时间切分：早期房源训练，近期房源测试（模拟“未来预测”场景）

2. **交互逻辑层面**（自然语言 → 查询条件）

   * 真实中不会有现成的标注数据
   * 你可以手写一批典型查询+标准化解析结果，自己做一个小型标注集，用来验证解析模块/大模型 Prompt 是否好用

---

## 4. 我们可以怎么往下走？

下一个步骤，我建议：

1. 先确定：你**打算先做哪个版本**：

   * 只做**传统筛选 + 简单排序**（偏工程）
   * 还是加上一个**小型“智能推荐/评分模型”**（偏算法/ML）
   * 或者优先做一个**自然语言解析 → 筛选**的 Demo（偏大模型落地）

2. 然后我们按模块开始设计：

   * 先把 Excel 字段结构（你打算怎么设计列）定下来
   * 再画一个简单模块图 + 数据流

---

我先问你一个问题，方便我们选路线：

> 这次你更想把这个题目做成：**偏传统数据系统（工程实力）**，还是 **要明显展示“我会用大模型/会做ML”的项目**？
> 你可以选一个主方向，我们再一起细化实现方案。
